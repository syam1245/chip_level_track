name: Keep Render Service Alive

on:
  schedule:
    # Runs at the 30th minute of every hour from 01:30 UTC to 18:30 UTC
    # This matches 07:00 AM to 12:00 AM (Midnight) IST
    - cron: '30 1-18 * * *'
  workflow_dispatch: 

jobs:
  ping:
    runs-on: ubuntu-latest
    
    steps:
      - name: Ping Render Service
        run: |
          echo "ğŸ”„ Pinging server to keep it alive..."
          response=$(curl -s -o /dev/null -w "%{http_code}" https://chip-level-track-2.onrender.com/api/health)
          
          if [ $response -eq 200 ]; then
            echo "âœ… Server is alive! (HTTP $response)"
          else
            echo "âš ï¸ Server responded with HTTP $response"
          fi
          
      - name: Log timestamp
        run: |
          echo "â° Last ping (UTC): $(date -u)"
          echo "ğŸ‡®ğŸ‡³ Last ping (IST approximation): $(date -d '+5 hours 30 minutes' -u)"